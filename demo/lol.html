<!doctype html>
<!-- HI I now know 150 digits of Tau/2. It would be nice if I learned 7 more
     in order to get to 157, or Pi/2. Wouldn't it?
     why am I ending this comment like this? because idk how to
  -->
<title>Implementation of Metaception #34</title>
<script>
function $(d){return this.document.getElementById(d)};

var words = ["ha","lol","rofl","roflol","roflmao"];
function intToEmot(int) {
	if (int<0x21 || 0x7E<int) {
		throw new TypeError("Expected int between 0x20 and 0x7E");
		return;
	}
	int -= 0x21;
	var i=0, sum=0;
	while (int>=sum) {
		sum += Math.pow(2,words[i].length);
		i++;
	}
	--i;
	sum -= Math.pow(2,words[i].length);
	
	
	var word    = words[i],
	    binary  = (int - sum).toString(2),
	    newword = "";
	
	while (binary.length<word.length) {
		binary = "0" + binary;
	}
	
	for (i=0;i<word.length;i++) {
		if (binary.charAt(i) == "1") {
			newword += word.charAt(i).toUpperCase();
		} else {
			newword += word.charAt(i);
		}
	}
	return newword;
}
function encode() {
	var input = $("toEncode").value, output="";
	input = input.split("").map(function(el){
		var c = el.charCodeAt(0);
		if ((0x20 <= c && c <= 0x7E) || c == 0x0A) {
			return c;
		}
	});
	$("toEncode").value = String.fromCharCode.apply(null,input);
	
	for (var i=0;i<input.length;i++) {
		if (input[i] == 0x0A || input[i] == 0x20) {
			output += String.fromCharCode(input[i]);
		} else {
			output += intToEmot(input[i]);
		}
	}
	$("toDecode").value = output;
}
function decode() {
	alert("Not implemented yet!");
}
</script>


<body>
Type some text to convert! Only characters on a standard US keyboard are allowed.

<br />
<textarea rows="10" cols="40" id="toEncode"></textarea>
<br />
<button onclick="encode()">Encode</button>
<br /><br />
Output:
<br />
<textarea rows="10" cols="40" id="toDecode"></textarea>
<br />
<button onclick="decode()">Decode</button>
