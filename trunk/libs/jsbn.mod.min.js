// Compiled using Closure Compiler (Simple) on 12/30/2011 http://closure-compiler.appspot.com/home

/* Modified by Kevin Geng, 2011 (with less than 2 days left!)
 * Released under the GPLv3.
 * 
 * Modified to reduce global scope pollution by utilizing closures,
 * removing function definitions that was used only to add to a
 * prototype, and replacing some things...
 * 
 * Soley using the BigInteger prototype should cause no harm.
 * At least no more than the original.
 *
 * I do not condone the use of UA sniffing.
 *
 * List of items that still enter the global scope...
 * (I was too lazy to create a giant closure or heavily rewrite the
 *   code to remove intAt and nbits)
 * - BigInteger
 * - intAt
 * - nbits
 * - Classic
 * - Montgomery
 */

// Copyright (c) 2005  Tom Wu
// All Rights Reserved.
// See "LICENSE" for details.

// Basic JavaScript BN library - subset useful for RSA encryption.

function BigInteger(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}
if("Microsoft Internet Explorer"==navigator.appName)BigInteger.prototype.am=function(a,b,c,d,f,e){for(var g=b&32767,b=b>>15;0<=--e;){var h=this[a]&32767,i=this[a++]>>15,k=b*h+i*g,h=g*h+((k&32767)<<15)+c[d]+(f&1073741823),f=(h>>>30)+(k>>>15)+b*i+(f>>>30);c[d++]=h&1073741823}return f},BigInteger.prototype.DB=30;else if("Netscape"!=navigator.appName){var am1=function(a,b,c,d,f,e){for(;0<=--e;){var g=b*this[a++]+c[d]+f,f=Math.floor(g/67108864);c[d++]=g&67108863}return f};BigInteger.prototype.DB=26}else BigInteger.prototype.am=
function(a,b,c,d,f,e){for(var g=b&16383,b=b>>14;0<=--e;){var h=this[a]&16383,i=this[a++]>>14,k=b*h+i*g,h=g*h+((k&16383)<<14)+c[d]+f,f=(h>>28)+(k>>14)+b*i;c[d++]=h&268435455}return f},BigInteger.prototype.DB=28;BigInteger.prototype.DV=1<<BigInteger.prototype.DB;BigInteger.prototype.DM=BigInteger.prototype.DV-1;BigInteger.prototype.FV=Math.pow(2,52);BigInteger.prototype.F1=52-BigInteger.prototype.DB;BigInteger.prototype.F2=104-BigInteger.prototype.DB-52;
var intAt=function(){var a=[],b,c;b=48;for(c=0;9>=c;++c)a[b++]=c;b=97;for(c=10;36>c;++c)a[b++]=c;b=65;for(c=10;36>c;++c)a[b++]=c;return function(b,c){var e=a[b.charCodeAt(c)];return null==e?-1:e}}();BigInteger.prototype.copyTo=function(a){for(var b=this.t-1;0<=b;--b)a[b]=this[b];a.t=this.t;a.s=this.s};BigInteger.prototype.fromInt=function(a){this.t=1;this.s=0>a?-1:0;0<a?this[0]=a:-1>a?this[0]=a+DV:this.t=0};
BigInteger.prototype.fromString=function(a,b){var c;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else if(4==b)c=2;else{this.fromRadix(a,b);return}this.s=this.t=0;for(var d=a.length,f=!1,e=0;0<=--d;){var g=8==c?a[d]&255:intAt(a,d);0>g?"-"==a.charAt(d)&&(f=!0):(f=!1,0==e?this[this.t++]=g:e+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-e)-1)<<e,this[this.t++]=g>>this.DB-e):this[this.t-1]|=g<<e,e+=c,e>=this.DB&&(e-=this.DB))}if(8==c&&0!=(a[0]&128))this.s=-1,0<e&&(this[this.t-
1]|=(1<<this.DB-e)-1<<e);this.clamp();f&&BigInteger.ZERO.subTo(this,this)};BigInteger.prototype.clamp=function(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t};
BigInteger.prototype.toString=function(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else if(4==a)a=2;else return this.toRadix(a);var b=(1<<a)-1,c,d=!1,f="",e=this.t,g=this.DB-e*this.DB%a;if(0<e--){g<this.DB&&0<this[e]>>g&&(d=!0,f="0123456789abcdefghijklmnopqrstuvwxyz".charAt(n));for(;0<=e;)g<a?(c=(this[e]&(1<<g)-1)<<a-g,c|=this[--e]>>(g+=this.DB-a)):(c=this[e]>>(g-=a)&b,0>=g&&(g+=this.DB,--e)),0<c&&(d=!0),d&&(f+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(c))}return d?
f:"0"};BigInteger.prototype.negate=function(){var a=new BigInteger(null);BigInteger.ZERO.subTo(this,a);return a};BigInteger.prototype.abs=function(){return 0>this.s?this.negate():this};BigInteger.prototype.compareTo=function(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t,b=c-a.t;if(0!=b)return b;for(;0<=--c;)if(0!=(b=this[c]-a[c]))return b;return 0};
function nbits(a){var b=1,c;if(0!=(c=a>>>16))a=c,b+=16;if(0!=(c=a>>8))a=c,b+=8;if(0!=(c=a>>4))a=c,b+=4;if(0!=(c=a>>2))a=c,b+=2;0!=a>>1&&(b+=1);return b}BigInteger.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)};BigInteger.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;0<=c;--c)b[c+a]=this[c];for(c=a-1;0<=c;--c)b[c]=0;b.t=this.t+a;b.s=this.s};
BigInteger.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0);b.s=this.s};BigInteger.prototype.lShiftTo=function(a,b){var c=a%this.DB,d=this.DB-c,f=(1<<d)-1,e=Math.floor(a/this.DB),g=this.s<<c&this.DM,h;for(h=this.t-1;0<=h;--h)b[h+e+1]=this[h]>>d|g,g=(this[h]&f)<<c;for(h=e-1;0<=h;--h)b[h]=0;b[e]=g;b.t=this.t+e+1;b.s=this.s;b.clamp()};
BigInteger.prototype.rShiftTo=function(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)b.t=0;else{var d=a%this.DB,f=this.DB-d,e=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&e)<<f,b[g-c]=this[g]>>d;0<d&&(b[this.t-c-1]|=(this.s&e)<<f);b.t=this.t-c;b.clamp()}};
BigInteger.prototype.subTo=function(a,b){for(var c=0,d=0,f=Math.min(a.t,this.t);c<f;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0;-1>d?b[c++]=this.DV+d:0<d&&(b[c++]=d);b.t=c;b.clamp()};
BigInteger.prototype.multiplyTo=function(a,b){var c=this.abs(),d=a.abs(),f=c.t;for(b.t=f+d.t;0<=--f;)b[f]=0;for(f=0;f<d.t;++f)b[f+c.t]=c.am(0,d[f],b,f,0,c.t);b.s=0;b.clamp();this.s!=a.s&&BigInteger.ZERO.subTo(b,b)};BigInteger.prototype.squareTo=function(a){for(var b=this.abs(),c=a.t=2*b.t;0<=--c;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);if((a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV)a[c+b.t]-=b.DV,a[c+b.t+1]=1}0<a.t&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1));a.s=0;a.clamp()};
BigInteger.prototype.divRemTo=function(a,b,c){var d=a.abs();if(!(0>=d.t)){var f=this.abs();if(f.t<d.t)null!=b&&b.fromInt(0),null!=c&&this.copyTo(c);else{null==c&&(c=new BigInteger(null));var e=new BigInteger(null),g=this.s,a=a.s,h=this.DB-nbits(d[d.t-1]);0<h?(d.lShiftTo(h,e),f.lShiftTo(h,c)):(d.copyTo(e),f.copyTo(c));d=e.t;f=e[d-1];if(0!=f){var i=f*(1<<this.F1)+(1<d?e[d-2]>>this.F2:0),k=this.FV/i,i=(1<<this.F1)/i,p=1<<this.F2,l=c.t,m=l-d,j=null==b?new BigInteger(null):b;e.dlShiftTo(m,j);0<=c.compareTo(j)&&
(c[c.t++]=1,c.subTo(j,c));BigInteger.ONE.dlShiftTo(d,j);for(j.subTo(e,e);e.t<d;)e[e.t++]=0;for(;0<=--m;){var o=c[--l]==f?this.DM:Math.floor(c[l]*k+(c[l-1]+p)*i);if((c[l]+=e.am(0,o,c,m,0,d))<o){e.dlShiftTo(m,j);for(c.subTo(j,c);c[l]<--o;)c.subTo(j,c)}}null!=b&&(c.drShiftTo(d,b),g!=a&&BigInteger.ZERO.subTo(b,b));c.t=d;c.clamp();0<h&&c.rShiftTo(h,c);0>g&&BigInteger.ZERO.subTo(c,c)}}}};
BigInteger.prototype.mod=function(a){var b=new BigInteger(null);this.abs().divRemTo(a,null,b);0>this.s&&0<b.compareTo(BigInteger.ZERO)&&a.subTo(b,b);return b};function Classic(a){this.m=a}Classic.prototype.convert=function(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a};Classic.prototype.revert=function(a){return a};Classic.prototype.reduce=function(a){a.divRemTo(this.m,null,a)};Classic.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c);this.reduce(c)};
Classic.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};BigInteger.prototype.invDigit=function(){if(1>this.t)return 0;var a=this[0];if(0==(a&1))return 0;var b=a&3,b=b*(2-(a&15)*b)&15,b=b*(2-(a&255)*b)&255,b=b*(2-((a&65535)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV;return 0<b?this.DV-b:-b};function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}
Montgomery.prototype.convert=function(a){var b=new BigInteger(null);a.abs().dlShiftTo(this.m.t,b);b.divRemTo(this.m,null,b);0>a.s&&0<b.compareTo(BigInteger.ZERO)&&this.m.subTo(b,b);return b};Montgomery.prototype.revert=function(a){var b=new BigInteger(null);a.copyTo(b);this.reduce(b);return b};
Montgomery.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=a[b]&32767,d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM,c=b+this.m.t;for(a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)};Montgomery.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};Montgomery.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c);this.reduce(c)};
BigInteger.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};BigInteger.prototype.exp=function(a,b){if(4294967295<a||1>a)return BigInteger.ONE;var c=new BigInteger(null),d=new BigInteger(null),f=b.convert(this),e=nbits(a)-1;for(f.copyTo(c);0<=--e;)if(b.sqrTo(c,d),0<(a&1<<e))b.mulTo(d,f,c);else var g=c,c=d,d=g;return b.revert(c)};BigInteger.prototype.modPowInt=function(a,b){var c;c=256>a||b.isEven()?new Classic(b):new Montgomery(b);return this.exp(a,c)};BigInteger.ZERO=new BigInteger(null);
BigInteger.ONE=new BigInteger(null);BigInteger.ZERO.fromInt(0);BigInteger.ONE.fromInt(1);