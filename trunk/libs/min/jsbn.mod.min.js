/* Modified by Kevin Geng, 2011-12
 * This file consists of jsbn.mod.js and jsbn2.mod.js
 * Compiled using Closure Compiler (Simple) on 02/09/2012 http://closure-compiler.appspot.com/home
 * 
 * Released under the GPLv3; see /trunk/LICENSE for details.
 * See the unminified files in ../mod for details on changes to the original.
 */
// Copyright (c) 2005  Tom Wu
// All Rights Reserved.
// See "LICENSE" for details.

// Basic JavaScript BN library - subset useful for RSA encryption.

function BigInteger(a,c,b){null!=a&&("number"==typeof a?this.fromNumber(a,c,b):null==c&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,c))}
(function(a){"Microsoft Internet Explorer"==a?(BigInteger.prototype.am=function(a,b,d,f,e,g){for(var h=b&32767,b=b>>15;0<=--g;){var i=this[a]&32767,k=this[a++]>>15,l=b*i+k*h,i=h*i+((l&32767)<<15)+d[f]+(e&1073741823),e=(i>>>30)+(l>>>15)+b*k+(e>>>30);d[f++]=i&1073741823}return e},BigInteger.prototype.DB=30):"Netscape"!=a?BigInteger.prototype.DB=26:(BigInteger.prototype.am=function(a,b,d,f,e,g){for(var h=b&16383,b=b>>14;0<=--g;){var i=this[a]&16383,k=this[a++]>>14,l=b*i+k*h,i=h*i+((l&16383)<<14)+d[f]+
e,e=(i>>28)+(l>>14)+b*k;d[f++]=i&268435455}return e},BigInteger.prototype.DB=28)})(navigator.appName);BigInteger.prototype.DV=1<<BigInteger.prototype.DB;BigInteger.prototype.DM=BigInteger.prototype.DV-1;BigInteger.prototype.FV=Math.pow(2,52);BigInteger.prototype.F1=52-BigInteger.prototype.DB;BigInteger.prototype.F2=104-BigInteger.prototype.DB-52;
var intAt=function(){var a=[],c,b;c=48;for(b=0;9>=b;++b)a[c++]=b;c=97;for(b=10;36>b;++b)a[c++]=b;c=65;for(b=10;36>b;++b)a[c++]=b;return function(b,c){var e=a[b.charCodeAt(c)];return null==e?-1:e}}();BigInteger.prototype.copyTo=function(a){for(var c=this.t-1;0<=c;--c)a[c]=this[c];a.t=this.t;a.s=this.s};BigInteger.prototype.fromInt=function(a){this.t=1;this.s=0>a?-1:0;0<a?this[0]=a:-1>a?this[0]=a+DV:this.t=0;return this};
BigInteger.prototype.fromString=function(a,c){var b;if(16==c)b=4;else if(8==c)b=3;else if(256==c)b=8;else if(2==c)b=1;else if(32==c)b=5;else if(4==c)b=2;else{this.fromRadix(a,c);return}this.s=this.t=0;for(var d=a.length,f=!1,e=0;0<=--d;){var g=8==b?a[d]&255:intAt(a,d);0>g?"-"==a.charAt(d)&&(f=!0):(f=!1,0==e?this[this.t++]=g:e+b>this.DB?(this[this.t-1]|=(g&(1<<this.DB-e)-1)<<e,this[this.t++]=g>>this.DB-e):this[this.t-1]|=g<<e,e+=b,e>=this.DB&&(e-=this.DB))}8==b&&0!=(a[0]&128)&&(this.s=-1,0<e&&(this[this.t-
1]|=(1<<this.DB-e)-1<<e));this.clamp();f&&BigInteger.ZERO.subTo(this,this)};BigInteger.prototype.clamp=function(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t};
BigInteger.prototype.toString=function(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else if(4==a)a=2;else return this.toRadix(a);var c=(1<<a)-1,b,d=!1,f="",e=this.t,g=this.DB-e*this.DB%a;if(0<e--){g<this.DB&&0<this[e]>>g&&(d=!0,f="0123456789abcdefghijklmnopqrstuvwxyz".charAt(n));for(;0<=e;)g<a?(b=(this[e]&(1<<g)-1)<<a-g,b|=this[--e]>>(g+=this.DB-a)):(b=this[e]>>(g-=a)&c,0>=g&&(g+=this.DB,--e)),0<b&&(d=!0),d&&(f+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(b))}return d?
f:"0"};BigInteger.prototype.negate=function(){var a=new BigInteger(null);BigInteger.ZERO.subTo(this,a);return a};BigInteger.prototype.abs=function(){return 0>this.s?this.negate():this};BigInteger.prototype.compareTo=function(a){var c=this.s-a.s;if(0!=c)return c;var b=this.t,c=b-a.t;if(0!=c)return c;for(;0<=--b;)if(0!=(c=this[b]-a[b]))return c;return 0};
function nbits(a){var c=1,b;if(0!=(b=a>>>16))a=b,c+=16;if(0!=(b=a>>8))a=b,c+=8;if(0!=(b=a>>4))a=b,c+=4;if(0!=(b=a>>2))a=b,c+=2;0!=a>>1&&(c+=1);return c}BigInteger.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)};BigInteger.prototype.dlShiftTo=function(a,c){var b;for(b=this.t-1;0<=b;--b)c[b+a]=this[b];for(b=a-1;0<=b;--b)c[b]=0;c.t=this.t+a;c.s=this.s};
BigInteger.prototype.drShiftTo=function(a,c){for(var b=a;b<this.t;++b)c[b-a]=this[b];c.t=Math.max(this.t-a,0);c.s=this.s};BigInteger.prototype.lShiftTo=function(a,c){var b=a%this.DB,d=this.DB-b,f=(1<<d)-1,e=Math.floor(a/this.DB),g=this.s<<b&this.DM,h;for(h=this.t-1;0<=h;--h)c[h+e+1]=this[h]>>d|g,g=(this[h]&f)<<b;for(h=e-1;0<=h;--h)c[h]=0;c[e]=g;c.t=this.t+e+1;c.s=this.s;c.clamp()};
BigInteger.prototype.rShiftTo=function(a,c){c.s=this.s;var b=Math.floor(a/this.DB);if(b>=this.t)c.t=0;else{var d=a%this.DB,f=this.DB-d,e=(1<<d)-1;c[0]=this[b]>>d;for(var g=b+1;g<this.t;++g)c[g-b-1]|=(this[g]&e)<<f,c[g-b]=this[g]>>d;0<d&&(c[this.t-b-1]|=(this.s&e)<<f);c.t=this.t-b;c.clamp()}};
BigInteger.prototype.subTo=function(a,c){for(var b=0,d=0,f=Math.min(a.t,this.t);b<f;)d+=this[b]-a[b],c[b++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;b<this.t;)d+=this[b],c[b++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;b<a.t;)d-=a[b],c[b++]=d&this.DM,d>>=this.DB;d-=a.s}c.s=0>d?-1:0;-1>d?c[b++]=this.DV+d:0<d&&(c[b++]=d);c.t=b;c.clamp()};
BigInteger.prototype.multiplyTo=function(a,c){var b=this.abs(),d=a.abs(),f=b.t;for(c.t=f+d.t;0<=--f;)c[f]=0;for(f=0;f<d.t;++f)c[f+b.t]=b.am(0,d[f],c,f,0,b.t);c.s=0;c.clamp();this.s!=a.s&&BigInteger.ZERO.subTo(c,c)};BigInteger.prototype.squareTo=function(a){for(var c=this.abs(),b=a.t=2*c.t;0<=--b;)a[b]=0;for(b=0;b<c.t-1;++b){var d=c.am(b,c[b],a,2*b,0,1);if((a[b+c.t]+=c.am(b+1,2*c[b],a,2*b+1,d,c.t-b-1))>=c.DV)a[b+c.t]-=c.DV,a[b+c.t+1]=1}0<a.t&&(a[a.t-1]+=c.am(b,c[b],a,2*b,0,1));a.s=0;a.clamp()};
BigInteger.prototype.divRemTo=function(a,c,b){var d=a.abs();if(!(0>=d.t)){var f=this.abs();if(f.t<d.t)null!=c&&c.fromInt(0),null!=b&&this.copyTo(b);else{null==b&&(b=new BigInteger(null));var e=new BigInteger(null),g=this.s,a=a.s,h=this.DB-nbits(d[d.t-1]);0<h?(d.lShiftTo(h,e),f.lShiftTo(h,b)):(d.copyTo(e),f.copyTo(b));d=e.t;f=e[d-1];if(0!=f){var i=f*(1<<this.F1)+(1<d?e[d-2]>>this.F2:0),k=this.FV/i,i=(1<<this.F1)/i,l=1<<this.F2,m=b.t,o=m-d,j=null==c?new BigInteger(null):c;e.dlShiftTo(o,j);0<=b.compareTo(j)&&
(b[b.t++]=1,b.subTo(j,b));BigInteger.ONE.dlShiftTo(d,j);for(j.subTo(e,e);e.t<d;)e[e.t++]=0;for(;0<=--o;){var p=b[--m]==f?this.DM:Math.floor(b[m]*k+(b[m-1]+l)*i);if((b[m]+=e.am(0,p,b,o,0,d))<p){e.dlShiftTo(o,j);for(b.subTo(j,b);b[m]<--p;)b.subTo(j,b)}}null!=c&&(b.drShiftTo(d,c),g!=a&&BigInteger.ZERO.subTo(c,c));b.t=d;b.clamp();0<h&&b.rShiftTo(h,b);0>g&&BigInteger.ZERO.subTo(b,b)}}}};
BigInteger.prototype.mod=function(a){var c=new BigInteger(null);this.abs().divRemTo(a,null,c);0>this.s&&0<c.compareTo(BigInteger.ZERO)&&a.subTo(c,c);return c};function Classic(a){this.m=a}Classic.prototype.convert=function(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a};Classic.prototype.revert=function(a){return a};Classic.prototype.reduce=function(a){a.divRemTo(this.m,null,a)};Classic.prototype.mulTo=function(a,c,b){a.multiplyTo(c,b);this.reduce(b)};
Classic.prototype.sqrTo=function(a,c){a.squareTo(c);this.reduce(c)};BigInteger.prototype.invDigit=function(){if(1>this.t)return 0;var a=this[0];if(0==(a&1))return 0;var c=a&3,c=c*(2-(a&15)*c)&15,c=c*(2-(a&255)*c)&255,c=c*(2-((a&65535)*c&65535))&65535,c=c*(2-a*c%this.DV)%this.DV;return 0<c?this.DV-c:-c};function Montgomery(a){this.m=a;this.mp=a.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<a.DB-15)-1;this.mt2=2*a.t}
Montgomery.prototype.convert=function(a){var c=new BigInteger(null);a.abs().dlShiftTo(this.m.t,c);c.divRemTo(this.m,null,c);0>a.s&&0<c.compareTo(BigInteger.ZERO)&&this.m.subTo(c,c);return c};Montgomery.prototype.revert=function(a){var c=new BigInteger(null);a.copyTo(c);this.reduce(c);return c};
Montgomery.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var c=0;c<this.m.t;++c){var b=a[c]&32767,d=b*this.mpl+((b*this.mph+(a[c]>>15)*this.mpl&this.um)<<15)&a.DM,b=c+this.m.t;for(a[b]+=this.m.am(0,d,a,c,0,this.m.t);a[b]>=a.DV;)a[b]-=a.DV,a[++b]++}a.clamp();a.drShiftTo(this.m.t,a);0<=a.compareTo(this.m)&&a.subTo(this.m,a)};Montgomery.prototype.sqrTo=function(a,c){a.squareTo(c);this.reduce(c)};Montgomery.prototype.mulTo=function(a,c,b){a.multiplyTo(c,b);this.reduce(b)};
BigInteger.prototype.isEven=function(){return 0==(0<this.t?this[0]&1:this.s)};BigInteger.prototype.exp=function(a,c){if(4294967295<a||1>a)return BigInteger.ONE;var b=new BigInteger(null),d=new BigInteger(null),f=c.convert(this),e=nbits(a)-1;for(f.copyTo(b);0<=--e;)if(c.sqrTo(b,d),0<(a&1<<e))c.mulTo(d,f,b);else var g=b,b=d,d=g;return c.revert(b)};BigInteger.prototype.modPowInt=function(a,c){var b;b=256>a||c.isEven()?new Classic(c):new Montgomery(c);return this.exp(a,b)};BigInteger.ZERO=(new BigInteger(null)).fromInt(0);
BigInteger.ONE=(new BigInteger(null)).fromInt(1);

// Extended JavaScript BN functions, required for RSA private ops.

// Version 1.1: new BigInteger("0", 10) returns "proper" zero
// Version 1.2: square() API, isProbablePrime fix

BigInteger.prototype.clone=function(){var a=new BigInteger(null);this.copyTo(a);return a};BigInteger.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]};BigInteger.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24};BigInteger.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16};
BigInteger.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))};BigInteger.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1};
BigInteger.prototype.toRadix=function(a){null==a&&(a=10);if(0==this.signum()||2>a||36<a)return"0";var b=this.chunkSize(a),b=Math.pow(a,b),d=(new BigInteger(null)).fromInt(b),c=new BigInteger(null),e=new BigInteger(null),g="";for(this.divRemTo(d,c,e);0<c.signum();)g=(b+e.intValue()).toString(a).substr(1)+g,c.divRemTo(d,c,e);return e.intValue().toString(a)+g};
BigInteger.prototype.fromRadix=function(a,b){this.fromInt(0);null==b&&(b=10);for(var d=this.chunkSize(b),c=Math.pow(b,d),e=!1,g=0,h=0,f=0;f<a.length;++f){var i=intAt(a,f);0>i?"-"==a.charAt(f)&&0==this.signum()&&(e=!0):(h=b*h+i,++g>=d&&(this.dMultiply(c),this.dAddOffset(h,0),h=g=0))}0<g&&(this.dMultiply(Math.pow(b,g)),this.dAddOffset(h,0));e&&BigInteger.ZERO.subTo(this,this)};
BigInteger.prototype.fromNumber=function(a,b,d){if("number"==typeof b)if(2>a)this.fromInt(1);else{this.fromNumber(a,d);this.testBit(a-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),function(a,b){return a|b},this);for(this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(BigInteger.ONE.shiftLeft(a-1),this)}else{var d=[],c=a&7;d.length=(a>>3)+1;b.nextBytes(d);d[0]=0<c?d[0]&(1<<c)-1:0;this.fromString(d,256)}};
BigInteger.prototype.toByteArray=function(){var a=this.t,b=[];b[0]=this.s;var d=this.DB-a*this.DB%8,c,e=0;if(0<a--){if(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d)b[e++]=c|this.s<<this.DB-d;for(;0<=a;)if(8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(c&128)&&(c|=-256),0==e&&(this.s&128)!=(c&128)&&++e,0<e||c!=this.s)b[e++]=c}return b};BigInteger.prototype.equals=function(a){return 0==this.compareTo(a)};
BigInteger.prototype.min=function(a){return 0>this.compareTo(a)?this:a};BigInteger.prototype.max=function(a){return 0<this.compareTo(a)?this:a};BigInteger.prototype.bitwiseTo=function(a,b,d){var c,e,g=Math.min(a.t,this.t);for(c=0;c<g;++c)d[c]=b(this[c],a[c]);if(a.t<this.t){e=a.s&this.DM;for(c=g;c<this.t;++c)d[c]=b(this[c],e);d.t=this.t}else{e=this.s&this.DM;for(c=g;c<a.t;++c)d[c]=b(e,a[c]);d.t=a.t}d.s=b(this.s,a.s);d.clamp()};
BigInteger.prototype.and=function(a){var b=new BigInteger(null);this.bitwiseTo(a,function(a,b){return a&b},b);return b};BigInteger.prototype.or=function(a){var b=new BigInteger(null);this.bitwiseTo(a,function(a,b){return a|b},b);return b};BigInteger.prototype.xor=function(a){var b=new BigInteger(null);this.bitwiseTo(a,function(a,b){return a^b},b);return b};BigInteger.prototype.andNot=function(a){var b=new BigInteger(null);this.bitwiseTo(a,function(a,b){return a&~b},b);return b};
BigInteger.prototype.not=function(){for(var a=new BigInteger(null),b=0;b<this.t;++b)a[b]=this.DM&~this[b];a.t=this.t;a.s=~this.s;return a};BigInteger.prototype.shiftLeft=function(a){var b=new BigInteger(null);0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b);return b};BigInteger.prototype.shiftRight=function(a){var b=new BigInteger(null);0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b);return b};
BigInteger.prototype.getLowestSetBit=function(a){return function(){for(var b=0;b<this.t;++b)if(0!=this[b])return b*this.DB+a(this[b]);return 0>this.s?this.t*this.DB:-1}}(function(a){if(0==a)return-1;var b=0;0==(a&65535)&&(a>>=16,b+=16);0==(a&255)&&(a>>=8,b+=8);0==(a&15)&&(a>>=4,b+=4);0==(a&3)&&(a>>=2,b+=2);0==(a&1)&&++b;return b});
BigInteger.prototype.bitCount=function(a){return function(){for(var b=0,d=this.s&this.DM,c=0;c<this.t;++c)b+=a(this[c]^d);return b}}(function(a){for(var b=0;0!=a;)a&=a-1,++b;return b});BigInteger.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)};BigInteger.prototype.changeBit=function(a,b){var d=BigInteger.ONE.shiftLeft(a);this.bitwiseTo(d,b,d);return d};
BigInteger.prototype.setBit=function(a){return this.changeBit(a,function(a,d){return a|d})};BigInteger.prototype.clearBit=function(a){return this.changeBit(a,function(a,d){return a&~d})};BigInteger.prototype.flipBit=function(a){return this.changeBit(a,function(a,d){return a^d})};
BigInteger.prototype.addTo=function(a,b){for(var d=0,c=0,e=Math.min(a.t,this.t);d<e;)c+=this[d]+a[d],b[d++]=c&this.DM,c>>=this.DB;if(a.t<this.t){for(c+=a.s;d<this.t;)c+=this[d],b[d++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;d<a.t;)c+=a[d],b[d++]=c&this.DM,c>>=this.DB;c+=a.s}b.s=0>c?-1:0;0<c?b[d++]=c:-1>c&&(b[d++]=this.DV+c);b.t=d;b.clamp()};BigInteger.prototype.add=function(a){var b=new BigInteger(null);this.addTo(a,b);return b};
BigInteger.prototype.subtract=function(a){var b=new BigInteger(null);this.subTo(a,b);return b};BigInteger.prototype.multiply=function(a){var b=new BigInteger(null);this.multiplyTo(a,b);return b};BigInteger.prototype.square=function(){var a=new BigInteger(null);this.squareTo(a);return a};BigInteger.prototype.divide=function(a){var b=new BigInteger(null);this.divRemTo(a,b,null);return b};BigInteger.prototype.remainder=function(a){var b=new BigInteger(null);this.divRemTo(a,null,b);return b};
BigInteger.prototype.divideAndRemainder=function(a){var b=new BigInteger(null),d=new BigInteger(null);this.divRemTo(a,b,d);return[b,d]};BigInteger.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t);++this.t;this.clamp()};BigInteger.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}};function NullExp(){}NullExp.prototype.convert=function(a){return a};
NullExp.prototype.revert=function(a){return a};NullExp.prototype.mulTo=function(a,b,d){a.multiplyTo(b,d)};NullExp.prototype.sqrTo=function(a,b){a.squareTo(b)};BigInteger.prototype.pow=function(a){return this.exp(a,new NullExp)};BigInteger.prototype.multiplyLowerTo=function(a,b,d){var c=Math.min(this.t+a.t,b);d.s=0;for(d.t=c;0<c;)d[--c]=0;var e;for(e=d.t-this.t;c<e;++c)d[c+this.t]=this.am(0,a[c],d,c,0,this.t);for(e=Math.min(a.t,b);c<e;++c)this.am(0,a[c],d,c,0,b-c);d.clamp()};
BigInteger.prototype.multiplyUpperTo=function(a,b,d){--b;var c=d.t=this.t+a.t-b;for(d.s=0;0<=--c;)d[c]=0;for(c=Math.max(b-this.t,0);c<a.t;++c)d[this.t+c-b]=this.am(b-c,a[c],d,0,0,this.t+c-b);d.clamp();d.drShiftTo(1,d)};function Barrett(a){this.r2=new BigInteger(null);this.q3=new BigInteger(null);BigInteger.ONE.dlShiftTo(2*a.t,this.r2);this.mu=this.r2.divide(a);this.m=a}
Barrett.prototype.convert=function(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=new BigInteger(null);a.copyTo(b);this.reduce(b);return b};Barrett.prototype.revert=function(a){return a};
Barrett.prototype.reduce=function(a){a.drShiftTo(this.m.t-1,this.r2);a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp());this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);for(this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,a)};Barrett.prototype.sqrTo=function(a,b){a.squareTo(b);this.reduce(b)};Barrett.prototype.mulTo=function(a,b,d){a.multiplyTo(b,d);this.reduce(d)};
BigInteger.prototype.modPow=function(a,b){var d=a.bitLength(),c,e=(new BigInteger(null)).fromInt(1),g;if(0>=d)return e;c=18>d?1:48>d?3:144>d?4:768>d?5:6;g=8>d?new Classic(b):b.isEven()?new Barrett(b):new Montgomery(b);var h=[],f=3,i=c-1,m=(1<<c)-1;h[1]=g.convert(this);if(1<c){d=new BigInteger(null);for(g.sqrTo(h[1],d);f<=m;)h[f]=new BigInteger(null),g.mulTo(d,h[f-2],h[f]),f+=2}for(var j=a.t-1,k,n=!0,l=new BigInteger(null),d=nbits(a[j])-1;0<=j;){d>=i?k=a[j]>>d-i&m:(k=(a[j]&(1<<d+1)-1)<<i-d,0<j&&(k|=
a[j-1]>>this.DB+d-i));for(f=c;0==(k&1);)k>>=1,--f;if(0>(d-=f))d+=this.DB,--j;if(n)h[k].copyTo(e),n=!1;else{for(;1<f;)g.sqrTo(e,l),g.sqrTo(l,e),f-=2;0<f?g.sqrTo(e,l):(f=e,e=l,l=f);g.mulTo(l,h[k],e)}for(;0<=j&&0==(a[j]&1<<d);)g.sqrTo(e,l),f=e,e=l,l=f,0>--d&&(d=this.DB-1,--j)}return g.revert(e)};
BigInteger.prototype.gcd=function(a){var b=0>this.s?this.negate():this.clone(),a=0>a.s?a.negate():a.clone();if(0>b.compareTo(a))var d=b,b=a,a=d;var d=b.getLowestSetBit(),c=a.getLowestSetBit();if(0>c)return b;d<c&&(c=d);0<c&&(b.rShiftTo(c,b),a.rShiftTo(c,a));for(;0<b.signum();)0<(d=b.getLowestSetBit())&&b.rShiftTo(d,b),0<(d=a.getLowestSetBit())&&a.rShiftTo(d,a),0<=b.compareTo(a)?(b.subTo(a,b),b.rShiftTo(1,b)):(a.subTo(b,a),a.rShiftTo(1,a));0<c&&a.lShiftTo(c,a);return a};
BigInteger.prototype.modInt=function(a){if(0>=a)return 0;var b=this.DV%a,d=0>this.s?a-1:0;if(0<this.t)if(0==b)d=this[0]%a;else for(var c=this.t-1;0<=c;--c)d=(b*d+this[c])%a;return d};
BigInteger.prototype.modInverse=function(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return BigInteger.ZERO;for(var d=a.clone(),c=this.clone(),e=(new BigInteger(null)).fromInt(1),g=(new BigInteger(null)).fromInt(0),h=(new BigInteger(null)).fromInt(0),f=(new BigInteger(null)).fromInt(1);0!=d.signum();){for(;d.isEven();){d.rShiftTo(1,d);if(b){if(!e.isEven()||!g.isEven())e.addTo(this,e),g.subTo(a,g);e.rShiftTo(1,e)}else g.isEven()||g.subTo(a,g);g.rShiftTo(1,g)}for(;c.isEven();){c.rShiftTo(1,
c);if(b){if(!h.isEven()||!f.isEven())h.addTo(this,h),f.subTo(a,f);h.rShiftTo(1,h)}else f.isEven()||f.subTo(a,f);f.rShiftTo(1,f)}0<=d.compareTo(c)?(d.subTo(c,d),b&&e.subTo(h,e),g.subTo(f,g)):(c.subTo(d,c),b&&h.subTo(e,h),f.subTo(g,f))}if(0!=c.compareTo(BigInteger.ONE))return BigInteger.ZERO;if(0<=f.compareTo(a))return f.subtract(a);if(0>f.signum())f.addTo(a,f);else return f;return 0>f.signum()?f.add(a):f};
(function(){var a=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,
727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],b=67108864/a[a.length-1];BigInteger.prototype.isProbablePrime=function(d){var c,e=this.abs();if(1==e.t&&e[0]<=a[a.length-1]){for(c=0;c<a.length;++c)if(e[0]==a[c])return!0;return!1}if(e.isEven())return!1;for(c=1;c<a.length;){for(var g=a[c],h=c+1;h<a.length&&g<b;)g*=a[h++];for(g=e.modInt(g);c<h;)if(0==g%a[c++])return!1}return e.millerRabin(d)};
BigInteger.prototype.millerRabin=function(b){var c=this.subtract(BigInteger.ONE),e=c.getLowestSetBit();if(0>=e)return!1;var g=c.shiftRight(e),b=b+1>>1;b>a.length&&(b=a.length);for(var h=new BigInteger(null),f=0;f<b;++f){h.fromInt(a[Math.floor(Math.random()*a.length)]);var i=h.modPow(g,this);if(0!=i.compareTo(BigInteger.ONE)&&0!=i.compareTo(c)){for(var m=1;m++<e&&0!=i.compareTo(c);)if(i=i.modPowInt(2,this),0==i.compareTo(BigInteger.ONE))return!1;if(0!=i.compareTo(c))return!1}}return!0}})();